---
kind: pipeline
type: docker
name: build

workspace:
  path: /microservice

steps:
- name: codegen
  image: tullo/microservice-build
  pull: always
  commands:
  - protoc --proto_path=$GOPATH/src:. -Irpc/stats --go_out=paths=source_relative:. rpc/stats/stats.proto
  - go mod tidy > /dev/null 2>&1
  - go fmt ./... > /dev/null 2>&1
